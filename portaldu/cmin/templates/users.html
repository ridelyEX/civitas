{% extends 'master.html' %}{% load static %}

{% block head %}
    {% load django_bootstrap5 %}
    {% bootstrap_css %}
    {% bootstrap_javascript %}
    <link rel="stylesheet" href="{% static 'cminStyles/userStyles.css' %}?v=6">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<title>Sign in</title>
{% endblock %}

{% block content %}{% include 'navmin.html' %}

<main class="user-container">
    <div class="page-header">
        <h2 class="page-title">
            <i class="fas fa-user-plus me-2"></i>
            Crear Usuario
        </h2>
        <p class="page-subtitle">Registra un nuevo usuario en el sistema</p>
    </div>

    <div class="form-wrapper">
        <form method="post" enctype="multipart/form-data" action="{% url 'users' %}" class="user-form">
            {% csrf_token %}

            <div class="row g-4">
                <!-- Columna Izquierda -->
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="{{form.email.id_for_label}}" class="form-label">
                            <i class="fas fa-envelope me-2"></i>Correo electrónico
                        </label>
                        {{form.email}}
                    </div>

                    <div class="form-group">
                        <label for="id_first_name" class="form-label">
                            <i class="fas fa-user me-2"></i>Nombre(s)
                        </label>
                        {{form.first_name}}
                    </div>

                    <div class="form-group">
                        <label for="id_last_name" class="form-label">
                            <i class="fas fa-user me-2"></i>Apellido(s)
                        </label>
                        {{form.last_name}}
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-camera me-2"></i>Foto de perfil
                        </label>
                        <div class="photo-upload">
                            <button type="button" class="photo-btn" id="search">
                                <i class="fas fa-image me-2"></i>
                                Seleccionar foto
                            </button>
                            <small class="text-muted mt-2 d-block">Formatos: JPG, PNG (Máx. 2MB)</small>
                        </div>
                    </div>
                </div>

                <!-- Columna Derecha -->
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="id_username" class="form-label">
                            <i class="fas fa-user-tag me-2"></i>Nombre de usuario
                        </label>
                        {{form.username}}
                    </div>

                    <div class="form-group">
                        <label for="id_bday" class="form-label">
                            <i class="fas fa-calendar me-2"></i>Fecha de nacimiento
                        </label>
                        {{form.bday}}
                    </div>

                    <div class="form-group">
                        <label for="id_password" class="form-label">
                            <i class="fas fa-lock me-2"></i>Contraseña
                        </label>
                        {{form.password}}
                    </div>

                    <div class="form-group">
                        <label for="id_confirmP" class="form-label">
                            <i class="fas fa-lock me-2"></i>Confirmar contraseña
                        </label>
                        {{form.confirmP}}
                    </div>

                    <div class="form-group">
                        <label for="id_rol" class="form-label">
                            <i class="fas fa-user-shield me-2"></i>Rol del usuario
                        </label>
                        {{form.rol}}
                    </div>
                </div>
            </div>

            <!-- Input oculto para foto -->
            {{form.foto}}

            <!-- Botones de acción -->
            <div class="action-buttons">
                <button type="button" class="btn btn-secondary" id="back" data-url="{% url 'menu' %}">
                    <i class="fas fa-arrow-left me-2"></i>Volver
                </button>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-user-check me-2"></i>Registrar usuario
                </button>
            </div>
        </form>
    </div>
</main>

{% endblock %}

{% block footer %}
<script src="{% static 'cminScripts/cminBtns.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://npmcdn.com/flatpickr/dist/l10n/es.js"></script>
<script>
  flatpickr("#id_bday", {
    dateFormat: "Y-m-d",
    locale: "es",
    altInput: true,
    altFormat: "F j, Y",
  });

  document.getElementById("search").addEventListener('click', function(){
    document.getElementById("id_foto").click();
  });
</script>
{% endblock %}