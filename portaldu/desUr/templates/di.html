<!-- AÑADIR REQUIRED -->

{% extends 'base.html' %} {% load static %} {% block head %}
<link rel="stylesheet" href="{% static 'styles/form-optimized.css' %}?v=1" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

<title>Obras Públicas</title>
{% endblock %} {% block body %} {% include 'nav.html' %}
<form method="post">
  {% csrf_token %}
  <div class="main">
    <div class="titulo">
      <h1><b>Datos del interesado</b></h1>
    </div>
    <div class="left">
      <div class="form">
        <label for="nombre" class="text">Nombre:</label>
        <input
          type="text"
          class="input"
          id="nombre"
          name="nombre"
          placeholder="Nombre"
          required
          title="Ingrese un nombre"
          oninvalid="this.setCustomValidity('Ingrese un nombre')"
            oninput="this.setCustomValidity('')"
        />

        <label for="pApe" class="text">Apellido paterno:</label>
        <input
          type="text"
          id="pApe"
          class="input"
          name="pApe"
          placeholder="Apellido paterno"
          required
          oninvalid="this.setCustomValidity('Ingrese su apellido paterno')"
            oninput="this.setCustomValidity('')"
        />

        <label for="mApe" class="text">Apellido materno:</label>
        <input
          type="text"
          id="mApe"
          class="input"
          name="mApe"
          placeholder="Apellido materno"
          required
          oninvalid="this.setCustomValidity('Ingrese su apellido materno')"
            oninput="this.setCustomValidity('')"
        />

        <label for="bDay" class="text">Fecha de nacimiento:</label>
        <input
          id="bDay"
          name="bDay"
          type="text"
          placeholder="Fecha de nacimiento"
          required
          oninvalid="this.setCustomValidity('Ingrese su fecha de nacimiento')"
            oninput="this.setCustomValidity('')"
        />



        <label for="asunto" class="text">Asunto:</label>
        <select class="select" id="asunto" name="asunto" required oninvalid="this.setCustomValidity('Ingrese un asunto')" oninput="this.setCustomValidity('')">
          <option value="">Seleccione una opción</option>
          <option value="DOP00001">Arreglo de calles de terracería</option>
          <option value="DOP00002">Bacheo de calles</option>
          <option value="DOP00003">
            Limpieza de arroyos al sur de la ciudad
          </option>
          <option value="DOP00004">
            Limpieza o mantenimiento de rejillas pluviales
          </option>
          <option value="DOP00005">
            Pago de costo de participación en licitaciones de obra pública
          </option>
          <option value="DOP00006">Rehabilitación de calles</option>
          <option value="DOP00007">
            Retiro de escombro y material de arrastre
          </option>
          <option value="DOP00008">Solicitud de material caliche/Fresado (especificar)</option>
          <option value="DOP00009">Solicitud de pavimentación de calles</option>
          <option value="DOP00010">Solicitud de reductores de velocidad</option>
          <option value="DOP00011">Solicitud de pintura para señalamientos viales</option>
          <option value="DOP00012">Arreglo de derrumbe de bardas</option>
          <option value="DOP00013">Tapiado</option>
        </select>

         <div class="field">
          <fieldset>
            <legend>¿Pertenece a alguna etnia?</legend>
            <label for="ets">
            <input type="radio" id="ets" class="radio" name="et" onclick="habilitar(true)">
              Sí</label>
            <label for="etn">
            <input type="radio" id="etn" class="radio" name="et" onclick="habilitar(false)">
              No</label><br>
            <label for="etnia" class="text">Etnia:</label>
            <input type="text" id="etnia" name="etnia" class="input" placeholder="Etnia" disabled>
          </fieldset>
        </div>
      </div>
    </div>
    <div class="right">
      <div class="form">
        <label for="tel" class="text">Teléfono:</label>
        <input
          type="text"
          id="tel"
          maxlength="10"
          class="input"
          name="tel"
          placeholder="Teléfono"
          pattern="[0-9]{10}"
          title="El teléfono debe tener 10 dígitos numéricos."
          required
          oninvalid="this.setCustomValidity('Ingrese un número de teléfono')"
          oninput="this.setCustomValidity('')"
        />

        <label for="curp" class="text">CURP:</label>
        <input
          type="text"
          id="curp"
          maxlength="18"
          class="input"
          name="curp"
          placeholder="CURP"
          required
          oninvalid="this.setCustomValidity('Ingrese su CURP')"
          oninput="this.setCustomValidity('')"
        />

        <label for="sexo" class="text">Género:</label>
        <select class="select" id="sexo" name="sexo" required oninvalid="this.setCustomValidity('Ingrese su sexo')" oninput="this.setCustomValidity('')">
          <option value="">Seleccione un opción</option>
          <option value="hombre">Hombre</option>
          <option value="mujer">Mujer</option>
          <option value="otro">Otro</option>
        </select>



        <label for="dir" class="text" >Dirección:</label>
        <input
          type="text"
          id="dir"
          class="input"
          name="dir"
          placeholder="Dirección: calle, colonia, número ex., C.P."
          value="{{dir}}"
          required
          oninvalid="this.setCustomValidity('Ingrese una dirección')"
          oninput="this.setCustomValidity('')"
        />
        <div class="plus">
          <button
                  type="button"
                  class="addbtn"
                  id="ubi"
                  onclick="openm()">
                  <span class="addicon">
                    <img src="{% static 'images/addw.png' %}" alt="add" class="add" />
                  </span>
            <span class="txt">Añadir dirección</span>
          </button>
        </div>

         <div class="field">
          <fieldset>
            <legend>¿Tiene alguna discapacidad?</legend>
            <label for="discs">
            <input type="radio" id="discs" name="disc" class="radio" onclick="habilitarD(true)">
              Sí</label>
            <label for="discn">
            <input type="radio" id="discn" name="disc" class="radio" onclick="habilitarD(false)">
              No</label><br>
            <label for="disc" class="text">Discapacidad:</label>
            <select name="discapacidad" id="disc" class="select" disabled>
              <option value="">Seleccione una opción</option>
              <option value="Persona con discapacidad motriz">Persona con discapacidad motriz</option>
              <option value="Persona con discapacidad auditiva">Persona con discapacidad auditiva</option>
              <option value="Persona con discapacidad visual">Persona con discapacidad visual</option>
              <option value="Persona con discapacidad intelectual">Persona con discapacidad intelectual</option>
              <option value="Persona con discapacidad psicosocial">Persona con discapacidad psicosocial</option>
            </select>
            <!--input type="text" name="discapacidad" id="disc" class="input" placeholder="Discapacidad" disabled-->
          </fieldset>
        </div>
      </div>
    </div>
     <div class="field">
          <fieldset>
            <legend>¿Pertenece a algún grupo vulnerable?</legend>
            <label for="vulnerabless">
            <input type="radio" id="vulnerabless" name="vul" class="radio" onclick="habilitarV(true)">
              Sí</label>
            <label for="vulnerablesn">
            <input type="radio" id="vulnerablesn" name="vul" class="radio" onclick="habilitarV(false)">
              No</label><br>
            <label for="vulnerables" class="text">Grupo vulnerable:</label>
            <select name="vulnerables" id="vulnerables" class="select" disabled>
              <option value="">Seleccione una opción</option>
              <option value="Padre o madre soltero(a), divorciado(a) o viudo(a)">Padre o madre soltero(a), divorciado(a) o viudo(a)</option>
              <option value="Personas mayores de 60 años">Personas mayores de 60 años</option>
              <option value="Persona con discapacidad total permanente">Persona con discapacidad total permanente</option>
              <option value="Persona pensionadas o jubiladas">Persona pensionadas o jubiladas</option>
              <option value="Familiar de persona con discapacidad total o permanente">Familiar de persona con discapacidad total o permanente</option>
              <option value="Víctimas indirectas del delito de feminicidio">Víctimas indirectas del delito de feminicidio</option>
            </select>
            <!--input type="text" name="discapacidad" id="disc" class="input" placeholder="Discapacidad" disabled-->
          </fieldset>
        </div>
  </div>

  <div class="Ibottom">
    <div class="lBtn">
      <button type="button" class="back bbtn" id="back" data-url="{% url 'clear' %}">Regresar</button>
    </div>
    <div class="rBtn">
      <button type="submit" class="next nbtn" id="next">Siguiente</button>
    </div>
  </div>
</form>
<div class="modal hidden" id="modal">
  {% include 'modals/modal_map.html' %}
</div>
{% endblock %}

{% block footer %}

<script src="https://maps.googleapis.com/maps/api/js?key={{ google_key }}&libraries=places&callback=initMap" async defer></script>
<script src="{% static 'sripts/btnScripts.js' %}"></script>

<script>
  let map;
  let marker;

  function initMap() {
    const ubicacion = { lat: 28.6353, lng: -106.0889 };
    map = new google.maps.Map(document.getElementById("map"), {
      center: ubicacion,
      zoom: 15,
    });

    const geocoder = new google.maps.Geocoder();

    map.addListener("click", (e) => {
      const latLng = e.latLng;

      if (marker) {
        marker.setPosition(latLng);
      } else {
        marker = new google.maps.Marker({
          position: latLng,
          map: map,
        });
      }

      geocoder.geocode({ location: latLng }, (results, status) => {
        if (status === "OK" && results[0]) {
          document.getElementById("dirr").value = results[0].formatted_address;
        } else {
          console.error("No se pudo obtener la dirección: " + status);
        }
      });
    });
  }

  document.getElementById("mNext").addEventListener("click", function () {
    const dirInput = document.getElementById("dirr").value;
    if (!dirInput.trim()) {
      alert("Por favor selecciona una dirección en el mapa.");
      return;
    }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://npmcdn.com/flatpickr/dist/l10n/es.js"></script>
<script src="{% static 'sripts/modals.js' %}"></script>

<script>
  flatpickr("#bDay",{
    dateFormat: "Y-m-d",
    locale: "es",
    altInput: "true",
    altFormat: "F j, Y",
  });
</script>
<script>
  function habilitar(estado){
      console.log(estado);
      document.getElementById("etnia").disabled = !estado;
      if (estado == false){
        console.log("aqui no hay nada");
        }else{
        console.log("aqui hay algo");
        }
    }
    function habilitarD(estado){
      document.getElementById("disc").disabled = !estado;
      if (estado == false){
      console.log("aqui no hay nada");
        }else{
        console.log("aqui hay algo");
        }
    }

    function habilitarV(estado){
        document.getElementById("vulnerables").disabled = !estado;
        if (estado == false){
        console.log("aqui no hay nada");
            }else{
            console.log("aqui hay algo");
            }
        }
</script>
<script src="{% static 'sripts/btnScripts.js' %}"></script>
<script>

  //enviar
  function enviar(){
    const text = document.getElementById('dirr').value;
    document.getElementById('dir').value = text;
    closem();
  }

  //mostrar
 function openm(){
    document.getElementById('modal').classList.remove('hidden');
    document.getElementById('modal').style.display = 'block';
}
//cerrar
function closem(){
    document.getElementById('modal').classList.add('hidden');
    document.getElementById('modal').style.display = 'none';
}
  window.onclick = function(event){
    var modal = document.getElementById('modal');
    if (event.target === modal){
      modal.style.display = "none";
    }
  }


</script>

{% endblock %}
